<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex, nofollow, noarchive, nosnippet" />
  <meta name="googlebot" content="noindex, nofollow" />
  <meta name="description" content="" />
  <title>Facture </title>
  <link rel="stylesheet" href="style.css?v=4.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>




  <script src="js/script.js" defer></script>
</head>

<body>
  <div id="toast-container" class="toast-container"></div>



  <div class="wrap" id="app" aria-live="polite">
    <div id="annonces-data" style="display:none;">

    </div>

    <!-- Demo Intro Modal Removed -->

    <button id="btn-annonces" class="btn-annonces-fixed" title="Nouveaut√©s" aria-label="Voir les nouveaut√©s">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <span class="notification-dot"></span>
      <div class="annonce-popup" id="annonce-popup"></div>
    </button>

    <button id="btn-logout" class="btn-logout-fixed" title="Se d√©connecter" aria-label="Se d√©connecter"
      style="display:none;">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
        <polyline points="16 17 21 12 16 7"></polyline>
        <line x1="21" y1="12" x2="9" y2="12"></line>
      </svg>
    </button>

    <header class="card" role="banner" aria-label="En-t√™te application">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:16px">
        <div style="display:flex; align-items:center; gap:14px">
          <h1>Outils de Facturation</h1>
          <p class="muted">Syst√®me de facturation h√¥teli√®re (DEMO)</p>
        </div>
        <div style="text-align:right">
          <div class="pill" id="preview-invoice-number" aria-live="polite">Facture n¬∞ ‚Äî</div>
        </div>
      </div>
    </header>

    <main class="grid" role="main">

      <section class="card" aria-labelledby="form-title">
        <h2 id="form-title">Informations de facturation</h2>
        <form id="facture-form" novalidate>
          <div class="field">
            <label for="nom">Client <span aria-hidden="true">*</span></label>
            <input id="nom" name="nom" type="text" autocomplete="name" required aria-required="true"
              placeholder="Nom complet" />
          </div>
          <div class="field">
            <label for="adresse">Adresse <span aria-hidden="true">*</span></label>
            <input id="adresse" name="adresse" type="text" required aria-required="true" placeholder="Adresse " />
          </div>
          <div class="field">
            <label for="email">Adresse e-mail <span aria-hidden="true">*</span></label>
            <input id="email" name="email" type="email" inputmode="email" autocomplete="email" required
              aria-required="true" placeholder="client@email.com" />
          </div>

          <div class="row">
            <div class="field">
              <label for="nb-chambres">Nombre de chambres</label>
              <input id="nb-chambres" type="number" min="1" step="1" value="1" />
            </div>
            <div class="field">
              <label for="nb-clients">Nombre de clients</label>
              <input id="nb-clients" type="number" min="1" step="1" value="1" />
            </div>
          </div>

          <div id="liste-chambres" class="field" aria-live="polite"></div>

          <div class="row">
            <div class="field">
              <label for="pdj-switch">Petit-d√©jeuner</label>
              <label class="switch" aria-label="Activer le petit-d√©jeuner">
                <input type="checkbox" id="pdj-switch" />
                <span class="slider"></span>
                <span class="switch-text" aria-hidden="true">Non</span>
              </label>
            </div>

            <div class="field">
              <label for="nb-nuits">Nombre de nuits</label>
              <input id="nb-nuits" type="number" min="1" step="1" value="1" />
            </div>
          </div>
          <div class="field">
            <label for="collaborateur">Collaborateur</label>
            <div class="select-wrapper">
              <select id="collaborateur" name="collaborateur" required>
                <option value="" disabled selected hidden>Choisir un collaborateur</option>
                <option value="Agent A">Agent A</option>
                <option value="Agent B">Agent B</option>
                <option value="Agent C">Agent C</option>
                <option value="Agent D">Agent D</option>
                <option value="Agent E">Agent E</option>
              </select>
            </div>
          </div>
          <div class="toolbar" style="margin-top:16px">
            <button class="btn" type="button" id="btn-creer">Cr√©er la facture</button>
            <button class="btn secondary" type="button" id="btn-reset">R√©initialiser</button>
          </div>
        </form>
      </section>

      <aside class="card" aria-labelledby="side-title">
        <h2 id="side-title">Historique</h2>
        <div class="field">
          <p class="muted">Historique des 10 derni√®res factures.</p>
          <div class="history" id="history-list" aria-live="polite" aria-label="Historique des factures">
            <div class="muted" style="padding:8px">Aucune facture enregistr√©e</div>
          </div>
        </div>
        <div style="text-align: center; margin: 20px 0;">
          <button class="btn" id="btn-view-factures">Voir toutes les factures</button>
        </div>

        <div class="field">
          <h3>Pr√©visualisation</h3>
          <div class="invoice-preview">
            <div class="preview-line">
              <span>Total chambres:</span>
              <span id="preview-chambres">0,00 ‚Ç¨</span>
            </div>
            <div class="preview-line">
              <span>Petit-d√©jeuner:</span>
              <span id="preview-pdj">0,00 ‚Ç¨</span>
            </div>
            <div class="preview-line">
              <span>Total HT:</span>
              <span id="preview-ht">0,00 ‚Ç¨</span>
            </div>
            <div class="preview-line">
              <span>TVA:</span>
              <span id="preview-tva">0,00 ‚Ç¨</span>
            </div>
            <div class="preview-line">
              <span>Taxe de s√©jour:</span>
              <span id="preview-taxe">0,00 ‚Ç¨</span>
            </div>
            <div class="preview-line preview-total">
              <span>Total TTC:</span>
              <span id="preview-total">0,00 ‚Ç¨</span>
            </div>
          </div>
        </div>
      </aside>
    </main>


    <div class="floating-dock">
      <button class="btn" id="toggle-activity" aria-expanded="false" aria-controls="activity-panel"
        title="Ouvrir l'historique d'activit√©">Activit√©s</button>
      <button class="btn" id="toggle-dashboard" aria-expanded="false" aria-controls="dashboard-panel"
        title="Ouvrir le dashboard">üìä Dashboard</button>
      <button class="btn" id="toggle-admin" aria-expanded="false" aria-controls="admin-panel"
        title="Ouvrir les r√©glages">‚öôÔ∏è R√©glages</button>
    </div>

    <div id="admin-panel" role="dialog" aria-modal="true" aria-labelledby="admin-title">
      <div class="admin-head">
        <h2 id="admin-title">R√©glages</h2>
        <button class="btn ghost" id="close-admin" title="Fermer">‚úñ</button>
      </div>

      <div class="settings-group">
        <h3>Facturation</h3>
        <div class="field">
          <label for="admin-num-facture">Num√©ro de facture</label>
          <div class="input-group">
            <input id="admin-num-facture" type="text" inputmode="numeric" placeholder="Ex : 202508001" />
            <button class="btn ok" id="btn-apply-num" type="button">Appliquer</button>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="admin-tva">TVA (%)</label>
            <input id="admin-tva" type="number" min="0" step="0.1" value="10" />
          </div>
          <div class="field">
            <label for="admin-devise">Devise</label>
            <select id="admin-devise">
              <option value="‚Ç¨">‚Ç¨ Euro</option>
              <option value="$">$ Dollar</option>
              <option value="¬£">¬£ Livre</option>
            </select>
          </div>
        </div>
      </div>

      <div class="settings-group">
        <h3>Tarifs par d√©faut</h3>
        <div class="row">
          <div class="field">
            <label for="admin-pdj">Petit-d√©jeuner (‚Ç¨)</label>
            <input id="admin-pdj" type="number" min="0" step="0.1" value="8" />
          </div>
          <div class="field">
            <label for="admin-taxe">Taxe de s√©jour (‚Ç¨)</label>
            <input id="admin-taxe" type="number" min="0" step="0.01" value="2.86" />
          </div>
        </div>
      </div>

      <div class="settings-actions">
        <button class="btn primary full-width" id="btn-save-settings" type="button">Enregistrer les param√®tres</button>
        <button class="btn warn full-width" id="btn-apply-now" type="button">Appliquer √† la facture en cours</button>
        <button class="btn danger full-width" id="btn-reset-settings" type="button">R√©initialiser par
          d√©faut</button>
      </div>

      <button id="btn-logout" style="display:none;">D√©connexion</button>
    </div>

    <div id="activity-panel" role="dialog" aria-modal="true" aria-labelledby="activity-title">
      <div class="admin-head">
        <h2 id="activity-title">Activit√©</h2>
        <button class="btn ghost" id="close-activity" title="Fermer">‚úñ</button>
      </div>
      <div class="activity-warning">
        Les noms des collaborateurs sont d√©claratifs et peuvent √™tre inexacts (aucune v√©rification).
      </div>
      <div id="activity-list" class="activity-list">
        <div class="muted" style="text-align:center; padding:20px">Chargement...</div>
      </div>
    </div>

    <div id="dashboard-panel" role="dialog" aria-modal="true" aria-labelledby="dashboard-title">
      <div class="admin-head">
        <h2 id="dashboard-title">Dashboard</h2>
        <button class="btn ghost" id="close-dashboard" title="Fermer">‚úñ</button>
      </div>

      <div id="dashboard-auth" class="auth-container">
        <h3>Acc√®s s√©curis√©</h3>
        <p>Veuillez entrer le code d'acc√®s</p>
        <div class="field">
          <input type="password" id="dashboard-code" class="auth-input" maxlength="4" inputmode="numeric"
            placeholder="****" />
        </div>
        <button class="btn" id="dashboard-auth-btn">Acc√©der</button>
      </div>

      <div id="dashboard-content" style="display: none;">
        <div class="dashboard-section">
          <h3>Aper√ßu du mois</h3>
          <div class="dashboard-filters" style="margin-bottom: 16px; display: flex; gap: 8px;">
            <select id="dashboard-year" class="filter-select" style="flex: 1;">
            </select>
            <select id="dashboard-month" class="filter-select" style="flex: 1;">
              <option value="all">Toute l'ann√©e</option>
              <option value="01">Janvier</option>
              <option value="02">F√©vrier</option>
              <option value="03">Mars</option>
              <option value="04">Avril</option>
              <option value="05">Mai</option>
              <option value="06">Juin</option>
              <option value="07">Juillet</option>
              <option value="08">Ao√ªt</option>
              <option value="09">Septembre</option>
              <option value="10">Octobre</option>
              <option value="11">Novembre</option>
              <option value="12">D√©cembre</option>
            </select>
          </div>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value" id="stat-total">0,00 ‚Ç¨</div>
              <div class="stat-label">Chiffre d'affaires</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-count">0</div>
              <div class="stat-label">Factures</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-avg">0,00 ‚Ç¨</div>
              <div class="stat-label">Moyenne/facture</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-pdj">0%</div>
              <div class="stat-label">Avec petit-d√©j</div>
            </div>
          </div>
        </div>


        <div class="dashboard-actions split">
          <button id="export-csv" class="btn export-btn" onclick="exportData()">Exporter CSV</button>
          <button id="export-excel" class="btn export-btn" onclick="exportDataExcel()">Exporter Excel</button>
        </div>
        <div class="dashboard-actions split">
          <button class="btn secondary" id="btn-import-csv" type="button">Importer CSV</button>
          <button class="btn secondary" id="btn-import-excel" type="button">Importer Excel</button>
          <input type="file" id="import-csv" accept=".csv" style="display: none" />
          <input type="file" id="import-excel" accept=".xlsx,.xls" style="display: none" />
        </div>
      </div>
    </div>
  </div>
  </div>

  <div class="wrap factures-container" id="factures-container" style="display:none;">
    <div class="search-header">
      <div class="search-box">
        <input type="text" id="facture-search" placeholder="Rechercher une facture..." />
        <span class="search-icon">üîç</span>
      </div>
      <div class="filter-controls">
        <select class="filter-select" id="sort-by">
          <option value="date-desc">Plus r√©cent</option>
          <option value="date-asc">Plus ancien</option>
          <option value="amount-desc">Montant (‚Üì)</option>
          <option value="amount-asc">Montant (‚Üë)</option>
        </select>
        <select class="filter-select" id="filter-year">
          <!-- Populated by JS -->
        </select>
        <select class="filter-select" id="filter-month">
          <option value="all">Tous les mois</option>
          <option value="01">Janvier</option>
          <option value="02">F√©vrier</option>
          <option value="03">Mars</option>
          <option value="04">Avril</option>
          <option value="05">Mai</option>
          <option value="06">Juin</option>
          <option value="07">Juillet</option>
          <option value="08">Ao√ªt</option>
          <option value="09">Septembre</option>
          <option value="10">Octobre</option>
          <option value="11">Novembre</option>
          <option value="12">D√©cembre</option>
        </select>
      </div>
    </div>

    <div class="view-toggle">
      <button class="toggle-btn active" data-view="grid">Grille</button>
      <button class="toggle-btn" data-view="list">Liste</button>
    </div>



    <div class="factures-grid" id="factures-grid">
    </div>
    <div class="factures-list" id="factures-list">
    </div>

    <button class="btn secondary floating-back-btn" id="btn-back-to-app">Retour √† l'accueil</button>
  </div>

  <div id="facture-pdf">
    <div class="invoice" id="invoice-root" role="document" aria-label="Facture PDF">
      <div class="inv-head">
        <div class="inv-left">
          <div class="inv-seller">
            <h2>H√¥tel (DEMO)</h2>
            <p>Syst√®me de facturation h√¥teli√®re<br>Version d√©mo portfolio<br>Email : demo@example.com</p>
          </div>
        </div>
        <div class="inv-meta">
          <h3>Facture n¬∞ <span id="num-facture">‚Äî</span></h3>
          <p><span id="date-facture">‚Äî</span></p>
        </div>
      </div>

      <hr style="margin: 12px 0">

      <section aria-labelledby="client-title">
        <h3 id="client-title">Client</h3>
        <p><strong id="client-nom">‚Äî</strong><br>
          <span id="client-adresse">‚Äî</span><br>
          <span id="client-email">‚Äî</span>
        </p>
      </section>

      <section aria-labelledby="details-title">
        <h3 id="details-title">D√©tails</h3>
        <table aria-describedby="totaux-title">
          <thead>
            <tr>
              <th style="text-align:left">Description</th>
              <th>Unit√©s</th>
              <th>Prix Unitaire</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody id="ligne-facture"></tbody>
          <tfoot>
            <tr>
              <td colspan="3" style="text-align:right">Sous-total HT</td>
              <td id="total-ht">0,00</td>
            </tr>
            <tr>
              <td colspan="3" style="text-align:right">TVA (<span id="tva-rate">10</span>%)</td>
              <td id="tva">0,00</td>
            </tr>
            <tr>
              <td colspan="3" style="text-align:right">Taxe de s√©jour</td>
              <td id="taxe-sejour">0,00</td>
            </tr>
            <tr>
              <td colspan="3" style="text-align:right"><strong>Total TTC</strong></td>
              <td id="total-ttc"><strong>0,00</strong></td>
            </tr>
          </tfoot>
        </table>
      </section>

      <div id="mentions-legales"
        style="text-align: center; position: absolute; left: 0; right: 0; bottom: 15mm; width: 100%;">
        Version d√©mo - Donn√©es fictives √† des fins de d√©monstration uniquement
      </div>

      <div class="toolbar no-print" style="justify-content:center; margin-top:10px">
        <button class="btn secondary no-print" id="btn-back" type="button">‚Üê Retour</button>
        <button class="btn no-print" id="btn-download" type="button">T√©l√©charger PDF</button>
        <button class="btn no-print" id="btn-gmail" type="button" style="background:#d44638">Envoyer via Gmail</button>
        <button class="btn warn no-print" id="btn-modify" type="button">Modifier</button>
      </div>
    </div>
  </div>


</body>

</html>